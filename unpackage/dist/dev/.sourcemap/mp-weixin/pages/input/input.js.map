{"version":3,"file":"input.js","sources":["pages/input/input.vue","pages/input/input.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"header\">\n      <view class=\"title\">输入出生信息</view>\n      <view class=\"subtitle\">请准确填写出生时间，以获得精确的分析结果</view>\n    </view>\n    \n    <!-- 性别选择 -->\n    <view class=\"form-section\">\n      <view class=\"section-title\">性别</view>\n      <view class=\"gender-selector\">\n        <view \n          class=\"gender-item\" \n          :class=\"{ active: form.gender === '男' }\"\n          @tap=\"selectGender('男')\"\n        >\n          <text class=\"gender-icon\">👨</text>\n          <text class=\"gender-text\">男</text>\n        </view>\n        <view \n          class=\"gender-item\" \n          :class=\"{ active: form.gender === '女' }\"\n          @tap=\"selectGender('女')\"\n        >\n          <text class=\"gender-icon\">👩</text>\n          <text class=\"gender-text\">女</text>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 历法选择 -->\n    <view class=\"form-section\">\n      <view class=\"section-title\">历法</view>\n      <view class=\"calendar-selector\">\n        <view \n          class=\"calendar-item\" \n          :class=\"{ active: !form.isLunar }\"\n          @tap=\"selectCalendar(false)\"\n        >\n          <text class=\"calendar-text\">公历</text>\n          <text class=\"calendar-desc\">阳历</text>\n        </view>\n        <view \n          class=\"calendar-item\" \n          :class=\"{ active: form.isLunar }\"\n          @tap=\"selectCalendar(true)\"\n        >\n          <text class=\"calendar-text\">农历</text>\n          <text class=\"calendar-desc\">阴历</text>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 出生日期 -->\n    <view class=\"form-section\">\n      <view class=\"section-title\">出生日期</view>\n      <view class=\"date-selector\" @tap=\"showDatePicker\">\n        <view class=\"date-display\">\n          <text class=\"date-text\">{{ dateDisplayText }}</text>\n          <text class=\"date-arrow\">📅</text>\n        </view>\n      </view>\n    </view>\n    \n    <!-- 出生时间 -->\n    <view class=\"form-section\">\n      <view class=\"section-title\">出生时间</view>\n      <view class=\"time-selector\" @tap=\"showTimePicker\">\n        <view class=\"time-display\">\n          <text class=\"time-text\">{{ timeDisplayText }}</text>\n          <text class=\"time-arrow\">🕐</text>\n        </view>\n      </view>\n      <view class=\"time-note\">\n        <text class=\"note-text\">💡 出生时间对结果影响很大，请尽量准确填写</text>\n      </view>\n    </view>\n    \n    <!-- 提交按钮 -->\n    <view class=\"submit-section\">\n      <button class=\"submit-btn\" @tap=\"calculateBazi\" :disabled=\"!isFormValid\">\n        开始分析\n      </button>\n    </view>\n    \n    <!-- 日期选择器 -->\n    <picker\n      v-if=\"showDateModal\"\n      mode=\"date\"\n      :value=\"form.date\"\n      @change=\"onDateChange\"\n      @cancel=\"showDateModal = false\"\n    >\n      <view></view>\n    </picker>\n    \n    <!-- 时间选择器 -->\n    <picker\n      v-if=\"showTimeModal\"\n      mode=\"time\"\n      :value=\"form.time\"\n      @change=\"onTimeChange\"\n      @cancel=\"showTimeModal = false\"\n    >\n      <view></view>\n    </picker>\n  </view>\n</template>\n\n<script>\nimport BaziCalculator from '@/utils/bazi-calculator.js';\n\nexport default {\n  data() {\n    return {\n      form: {\n        gender: '男',\n        isLunar: false,\n        date: '',\n        time: '',\n        year: new Date().getFullYear(),\n        month: new Date().getMonth() + 1,\n        day: new Date().getDate(),\n        hour: 12,\n        minute: 0\n      },\n      showDateModal: false,\n      showTimeModal: false,\n      loading: false\n    };\n  },\n  \n  computed: {\n    dateDisplayText() {\n      if (!this.form.date) {\n        return '请选择出生日期';\n      }\n      const date = new Date(this.form.date);\n      return `${date.getFullYear()}年${date.getMonth() + 1}月${date.getDate()}日`;\n    },\n    \n    timeDisplayText() {\n      if (!this.form.time) {\n        return '请选择出生时间';\n      }\n      const [hour, minute] = this.form.time.split(':');\n      return `${hour}时${minute}分 (${this.getShiChenName(parseInt(hour))})`;\n    },\n    \n    isFormValid() {\n      return this.form.gender && this.form.date && this.form.time;\n    }\n  },\n  \n  onLoad() {\n    // 设置默认日期为今天\n    const now = new Date();\n    this.form.date = now.toISOString().split('T')[0];\n    this.form.time = '12:00';\n  },\n  \n  methods: {\n    selectGender(gender) {\n      this.form.gender = gender;\n    },\n    \n    selectCalendar(isLunar) {\n      this.form.isLunar = isLunar;\n    },\n    \n    showDatePicker() {\n      this.showDateModal = true;\n    },\n    \n    showTimePicker() {\n      this.showTimeModal = true;\n    },\n    \n    onDateChange(e) {\n      this.form.date = e.detail.value;\n      this.showDateModal = false;\n    },\n    \n    onTimeChange(e) {\n      this.form.time = e.detail.value;\n      this.showTimeModal = false;\n    },\n    \n    getShiChenName(hour) {\n      const shiChen = [\n        '子时', '丑时', '寅时', '卯时', '辰时', '巳时',\n        '午时', '未时', '申时', '酉时', '戌时', '亥时'\n      ];\n      const index = Math.floor((hour + 1) / 2) % 12;\n      return shiChen[index];\n    },\n    \n    async calculateBazi() {\n      if (!this.isFormValid) {\n        uni.showToast({\n          title: '请完善信息',\n          icon: 'none'\n        });\n        return;\n      }\n      \n      this.loading = true;\n      \n      try {\n        // 构建完整的出生日期时间\n        const [hour, minute] = this.form.time.split(':');\n        const birthDateTime = new Date(`${this.form.date}T${this.form.time}:00`);\n        \n        // 计算八字\n        const baziResult = BaziCalculator.calculateBazi(\n          birthDateTime,\n          this.form.gender,\n          this.form.isLunar\n        );\n        \n        // 保存到本地存储\n        this.saveBaziHistory(baziResult);\n        \n        // 跳转到结果页面\n        uni.navigateTo({\n          url: `/pages/result/result?data=${encodeURIComponent(JSON.stringify(baziResult))}`\n        });\n        \n      } catch (error) {\n        console.error('计算八字失败:', error);\n        uni.showToast({\n          title: '计算失败，请重试',\n          icon: 'none'\n        });\n      } finally {\n        this.loading = false;\n      }\n    },\n    \n    saveBaziHistory(baziResult) {\n      try {\n        let history = uni.getStorageSync('bazi_history') || [];\n        \n        // 添加时间戳和ID\n        const record = {\n          id: Date.now(),\n          timestamp: new Date().toISOString(),\n          data: baziResult\n        };\n        \n        history.unshift(record);\n        \n        // 最多保存20条记录\n        if (history.length > 20) {\n          history = history.slice(0, 20);\n        }\n        \n        uni.setStorageSync('bazi_history', history);\n      } catch (error) {\n        console.error('保存历史记录失败:', error);\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  min-height: 100vh;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  padding: 40rpx 30rpx;\n}\n\n.header {\n  text-align: center;\n  color: white;\n  margin-bottom: 60rpx;\n  \n  .title {\n    font-size: 48rpx;\n    font-weight: bold;\n    margin-bottom: 20rpx;\n  }\n  \n  .subtitle {\n    font-size: 26rpx;\n    opacity: 0.8;\n    line-height: 1.4;\n  }\n}\n\n.form-section {\n  background: white;\n  border-radius: 20rpx;\n  padding: 40rpx 30rpx;\n  margin-bottom: 30rpx;\n  box-shadow: 0 8rpx 25rpx rgba(0, 0, 0, 0.1);\n  \n  .section-title {\n    font-size: 32rpx;\n    font-weight: bold;\n    color: #2c3e50;\n    margin-bottom: 30rpx;\n  }\n}\n\n.gender-selector {\n  display: flex;\n  gap: 30rpx;\n  \n  .gender-item {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 30rpx;\n    border: 2rpx solid #ecf0f1;\n    border-radius: 15rpx;\n    transition: all 0.3s ease;\n    \n    &.active {\n      border-color: #3498db;\n      background-color: rgba(52, 152, 219, 0.1);\n    }\n    \n    .gender-icon {\n      font-size: 40rpx;\n      margin-bottom: 10rpx;\n    }\n    \n    .gender-text {\n      font-size: 28rpx;\n      color: #2c3e50;\n      font-weight: bold;\n    }\n  }\n}\n\n.calendar-selector {\n  display: flex;\n  gap: 30rpx;\n  \n  .calendar-item {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    padding: 30rpx;\n    border: 2rpx solid #ecf0f1;\n    border-radius: 15rpx;\n    transition: all 0.3s ease;\n    \n    &.active {\n      border-color: #e67e22;\n      background-color: rgba(230, 126, 34, 0.1);\n    }\n    \n    .calendar-text {\n      font-size: 30rpx;\n      color: #2c3e50;\n      font-weight: bold;\n      margin-bottom: 8rpx;\n    }\n    \n    .calendar-desc {\n      font-size: 24rpx;\n      color: #7f8c8d;\n    }\n  }\n}\n\n.date-selector, .time-selector {\n  .date-display, .time-display {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 25rpx 30rpx;\n    background-color: #f8f9fa;\n    border-radius: 15rpx;\n    border: 2rpx solid #ecf0f1;\n    \n    .date-text, .time-text {\n      font-size: 30rpx;\n      color: #2c3e50;\n      font-weight: 500;\n    }\n    \n    .date-arrow, .time-arrow {\n      font-size: 32rpx;\n    }\n  }\n}\n\n.time-note {\n  margin-top: 20rpx;\n  \n  .note-text {\n    font-size: 24rpx;\n    color: #7f8c8d;\n    line-height: 1.4;\n  }\n}\n\n.submit-section {\n  margin-top: 60rpx;\n  \n  .submit-btn {\n    width: 100%;\n    background: linear-gradient(45deg, #3498db, #2ecc71);\n    color: white;\n    font-size: 36rpx;\n    font-weight: bold;\n    padding: 30rpx;\n    border-radius: 50rpx;\n    border: none;\n    box-shadow: 0 8rpx 25rpx rgba(52, 152, 219, 0.3);\n    \n    &:disabled {\n      background: #bdc3c7;\n      box-shadow: none;\n    }\n  }\n}\n</style>","import MiniProgramPage from '/Users/cary/work/traditional-culture-helper/pages/input/input.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","BaziCalculator"],"mappings":"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"}