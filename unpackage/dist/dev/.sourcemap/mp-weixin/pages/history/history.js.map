{"version":3,"file":"history.js","sources":["pages/history/history.vue","pages/history/history.vue?type=page"],"sourcesContent":["<template>\n  <view class=\"container\">\n    <view class=\"header\">\n      <view class=\"title\">ÂéÜÂè≤ËÆ∞ÂΩï</view>\n      <view class=\"subtitle\">Êü•Áúã‰πãÂâçÁöÑÂàÜÊûêÁªìÊûú</view>\n    </view>\n    \n    <view v-if=\"historyList.length === 0\" class=\"empty-state\">\n      <view class=\"empty-icon\">üìö</view>\n      <view class=\"empty-text\">ÊöÇÊó†ÂéÜÂè≤ËÆ∞ÂΩï</view>\n      <view class=\"empty-desc\">ÂéªÊµãÁÆó‰∏Ä‰∏ãÂÖ´Â≠óÂêß</view>\n      <button class=\"empty-btn\" @tap=\"goToInput\">ÂºÄÂßãÊµãÁÆó</button>\n    </view>\n    \n    <view v-else class=\"history-list\">\n      <view \n        v-for=\"(item, index) in historyList\" \n        :key=\"item.id\"\n        class=\"history-item\"\n        @tap=\"viewResult(item)\"\n      >\n        <view class=\"item-header\">\n          <view class=\"person-info\">\n            <text class=\"gender-icon\">{{ item.data.gender === 'Áî∑' ? 'üë®' : 'üë©' }}</text>\n            <text class=\"gender-text\">{{ item.data.gender }}ÂëΩ</text>\n          </view>\n          <view class=\"delete-btn\" @tap.stop=\"deleteItem(index)\">\n            <text class=\"delete-icon\">üóëÔ∏è</text>\n          </view>\n        </view>\n        \n        <view class=\"bazi-preview\">\n          <view class=\"bazi-text\">\n            <text v-for=\"(pillar, pos) in item.data.baziString\" :key=\"pos\" class=\"pillar\">\n              {{ pillar }}\n            </text>\n          </view>\n        </view>\n        \n        <view class=\"item-details\">\n          <view class=\"detail-row\">\n            <text class=\"detail-label\">Âá∫Áîü:</text>\n            <text class=\"detail-value\">{{ formatBirthDate(item.data.birthDate.solar) }}</text>\n          </view>\n          <view class=\"detail-row\">\n            <text class=\"detail-label\">Âº∫Âº±:</text>\n            <text class=\"detail-value strength\">{{ item.data.analysis.qiangRuo.level }}</text>\n          </view>\n          <view class=\"detail-row\">\n            <text class=\"detail-label\">Ê†ºÂ±Ä:</text>\n            <text class=\"detail-value format\">{{ item.data.analysis.geJu.name }}</text>\n          </view>\n        </view>\n        \n        <view class=\"item-footer\">\n          <text class=\"timestamp\">{{ formatTimestamp(item.timestamp) }}</text>\n          <text class=\"view-arrow\">Êü•ÁúãËØ¶ÊÉÖ ‚Üí</text>\n        </view>\n      </view>\n    </view>\n    \n    <view v-if=\"historyList.length > 0\" class=\"clear-section\">\n      <button class=\"clear-btn\" @tap=\"clearAllHistory\">Ê∏ÖÁ©∫ÊâÄÊúâËÆ∞ÂΩï</button>\n    </view>\n  </view>\n</template>\n\n<script>\nexport default {\n  data() {\n    return {\n      historyList: []\n    };\n  },\n  \n  onShow() {\n    this.loadHistory();\n  },\n  \n  methods: {\n    loadHistory() {\n      try {\n        const history = uni.getStorageSync('bazi_history') || [];\n        this.historyList = history;\n      } catch (error) {\n        console.error('Âä†ËΩΩÂéÜÂè≤ËÆ∞ÂΩïÂ§±Ë¥•:', error);\n        this.historyList = [];\n      }\n    },\n    \n    viewResult(item) {\n      uni.navigateTo({\n        url: `/pages/result/result?data=${encodeURIComponent(JSON.stringify(item.data))}`\n      });\n    },\n    \n    deleteItem(index) {\n      uni.showModal({\n        title: 'Á°ÆËÆ§Âà†Èô§',\n        content: 'Á°ÆÂÆöË¶ÅÂà†Èô§ËøôÊù°ËÆ∞ÂΩïÂêóÔºü',\n        success: (res) => {\n          if (res.confirm) {\n            this.historyList.splice(index, 1);\n            this.saveHistory();\n            \n            uni.showToast({\n              title: 'Â∑≤Âà†Èô§',\n              icon: 'success'\n            });\n          }\n        }\n      });\n    },\n    \n    clearAllHistory() {\n      uni.showModal({\n        title: 'Á°ÆËÆ§Ê∏ÖÁ©∫',\n        content: 'Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÂéÜÂè≤ËÆ∞ÂΩïÂêóÔºüÊ≠§Êìç‰Ωú‰∏çÂèØÊÅ¢Â§ç„ÄÇ',\n        success: (res) => {\n          if (res.confirm) {\n            this.historyList = [];\n            this.saveHistory();\n            \n            uni.showToast({\n              title: 'Â∑≤Ê∏ÖÁ©∫',\n              icon: 'success'\n            });\n          }\n        }\n      });\n    },\n    \n    saveHistory() {\n      try {\n        uni.setStorageSync('bazi_history', this.historyList);\n      } catch (error) {\n        console.error('‰øùÂ≠òÂéÜÂè≤ËÆ∞ÂΩïÂ§±Ë¥•:', error);\n      }\n    },\n    \n    goToInput() {\n      uni.navigateTo({\n        url: '/pages/input/input'\n      });\n    },\n    \n    formatBirthDate(solarDate) {\n      return `${solarDate.year}Âπ¥${solarDate.month}Êúà${solarDate.day}Êó•`;\n    },\n    \n    formatTimestamp(timestamp) {\n      const date = new Date(timestamp);\n      const now = new Date();\n      const diffTime = now.getTime() - date.getTime();\n      const diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n      \n      if (diffDays === 0) {\n        return '‰ªäÂ§©';\n      } else if (diffDays === 1) {\n        return 'Êò®Â§©';\n      } else if (diffDays < 7) {\n        return `${diffDays}Â§©Ââç`;\n      } else {\n        return `${date.getMonth() + 1}Êúà${date.getDate()}Êó•`;\n      }\n    }\n  }\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.container {\n  min-height: 100vh;\n  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n  padding: 40rpx 30rpx;\n}\n\n.header {\n  text-align: center;\n  color: white;\n  margin-bottom: 60rpx;\n  \n  .title {\n    font-size: 48rpx;\n    font-weight: bold;\n    margin-bottom: 20rpx;\n  }\n  \n  .subtitle {\n    font-size: 26rpx;\n    opacity: 0.8;\n  }\n}\n\n.empty-state {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 100rpx 40rpx;\n  \n  .empty-icon {\n    font-size: 80rpx;\n    margin-bottom: 30rpx;\n  }\n  \n  .empty-text {\n    font-size: 32rpx;\n    color: white;\n    font-weight: bold;\n    margin-bottom: 15rpx;\n  }\n  \n  .empty-desc {\n    font-size: 26rpx;\n    color: rgba(255, 255, 255, 0.8);\n    margin-bottom: 50rpx;\n  }\n  \n  .empty-btn {\n    background: rgba(255, 255, 255, 0.2);\n    color: white;\n    border: 2rpx solid rgba(255, 255, 255, 0.3);\n    border-radius: 50rpx;\n    padding: 25rpx 50rpx;\n    font-size: 28rpx;\n    font-weight: bold;\n  }\n}\n\n.history-list {\n  .history-item {\n    background: white;\n    border-radius: 20rpx;\n    padding: 30rpx;\n    margin-bottom: 30rpx;\n    box-shadow: 0 8rpx 25rpx rgba(0, 0, 0, 0.1);\n    \n    .item-header {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin-bottom: 25rpx;\n      \n      .person-info {\n        display: flex;\n        align-items: center;\n        \n        .gender-icon {\n          font-size: 32rpx;\n          margin-right: 10rpx;\n        }\n        \n        .gender-text {\n          font-size: 28rpx;\n          font-weight: bold;\n          color: #2c3e50;\n        }\n      }\n      \n      .delete-btn {\n        padding: 10rpx;\n        \n        .delete-icon {\n          font-size: 28rpx;\n          opacity: 0.6;\n        }\n      }\n    }\n    \n    .bazi-preview {\n      text-align: center;\n      margin-bottom: 25rpx;\n      \n      .bazi-text {\n        .pillar {\n          display: inline-block;\n          font-size: 32rpx;\n          font-weight: bold;\n          color: #3498db;\n          margin: 0 15rpx;\n          padding: 10rpx 15rpx;\n          background: rgba(52, 152, 219, 0.1);\n          border-radius: 10rpx;\n        }\n      }\n    }\n    \n    .item-details {\n      .detail-row {\n        display: flex;\n        align-items: center;\n        margin-bottom: 12rpx;\n        \n        &:last-child {\n          margin-bottom: 0;\n        }\n        \n        .detail-label {\n          font-size: 24rpx;\n          color: #7f8c8d;\n          min-width: 80rpx;\n          margin-right: 20rpx;\n        }\n        \n        .detail-value {\n          font-size: 26rpx;\n          color: #2c3e50;\n          font-weight: 500;\n          \n          &.strength {\n            color: #e67e22;\n            font-weight: bold;\n          }\n          \n          &.format {\n            color: #8e44ad;\n            font-weight: bold;\n          }\n        }\n      }\n    }\n    \n    .item-footer {\n      display: flex;\n      justify-content: space-between;\n      align-items: center;\n      margin-top: 25rpx;\n      padding-top: 20rpx;\n      border-top: 1rpx solid #ecf0f1;\n      \n      .timestamp {\n        font-size: 22rpx;\n        color: #bdc3c7;\n      }\n      \n      .view-arrow {\n        font-size: 24rpx;\n        color: #3498db;\n        font-weight: 500;\n      }\n    }\n  }\n}\n\n.clear-section {\n  margin-top: 40rpx;\n  text-align: center;\n  \n  .clear-btn {\n    background: rgba(231, 76, 60, 0.2);\n    color: #e74c3c;\n    border: 2rpx solid rgba(231, 76, 60, 0.3);\n    border-radius: 50rpx;\n    padding: 20rpx 40rpx;\n    font-size: 26rpx;\n  }\n}\n</style>","import MiniProgramPage from '/Users/cary/work/traditional-culture-helper/pages/history/history.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni"],"mappings":";;AAoEA,MAAK,YAAU;AAAA,EACb,OAAO;AACL,WAAO;AAAA,MACL,aAAa,CAAC;AAAA;EAEjB;AAAA,EAED,SAAS;AACP,SAAK,YAAW;AAAA,EACjB;AAAA,EAED,SAAS;AAAA,IACP,cAAc;AACZ,UAAI;AACF,cAAM,UAAUA,cAAG,MAAC,eAAe,cAAc,KAAK,CAAA;AACtD,aAAK,cAAc;AAAA,MACnB,SAAO,OAAO;AACdA,sBAAc,MAAA,MAAA,SAAA,mCAAA,aAAa,KAAK;AAChC,aAAK,cAAc;MACrB;AAAA,IACD;AAAA,IAED,WAAW,MAAM;AACfA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK,6BAA6B,mBAAmB,KAAK,UAAU,KAAK,IAAI,CAAC,CAAC;AAAA,MACjF,CAAC;AAAA,IACF;AAAA,IAED,WAAW,OAAO;AAChBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,SAAS;AACf,iBAAK,YAAY,OAAO,OAAO,CAAC;AAChC,iBAAK,YAAW;AAEhBA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,YACR,CAAC;AAAA,UACH;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACF;AAAA,IAED,kBAAkB;AAChBA,oBAAAA,MAAI,UAAU;AAAA,QACZ,OAAO;AAAA,QACP,SAAS;AAAA,QACT,SAAS,CAAC,QAAQ;AAChB,cAAI,IAAI,SAAS;AACf,iBAAK,cAAc;AACnB,iBAAK,YAAW;AAEhBA,0BAAAA,MAAI,UAAU;AAAA,cACZ,OAAO;AAAA,cACP,MAAM;AAAA,YACR,CAAC;AAAA,UACH;AAAA,QACF;AAAA,MACF,CAAC;AAAA,IACF;AAAA,IAED,cAAc;AACZ,UAAI;AACFA,sBAAAA,MAAI,eAAe,gBAAgB,KAAK,WAAW;AAAA,MACnD,SAAO,OAAO;AACdA,sBAAc,MAAA,MAAA,SAAA,oCAAA,aAAa,KAAK;AAAA,MAClC;AAAA,IACD;AAAA,IAED,YAAY;AACVA,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACP,CAAC;AAAA,IACF;AAAA,IAED,gBAAgB,WAAW;AACzB,aAAO,GAAG,UAAU,IAAI,IAAI,UAAU,KAAK,IAAI,UAAU,GAAG;AAAA,IAC7D;AAAA,IAED,gBAAgB,WAAW;AACzB,YAAM,OAAO,IAAI,KAAK,SAAS;AAC/B,YAAM,MAAM,oBAAI;AAChB,YAAM,WAAW,IAAI,YAAY,KAAK,QAAO;AAC7C,YAAM,WAAW,KAAK,MAAM,YAAY,MAAO,KAAK,KAAK,GAAG;AAE5D,UAAI,aAAa,GAAG;AAClB,eAAO;AAAA,MACT,WAAW,aAAa,GAAG;AACzB,eAAO;AAAA,MACT,WAAW,WAAW,GAAG;AACvB,eAAO,GAAG,QAAQ;AAAA,aACb;AACL,eAAO,GAAG,KAAK,aAAa,CAAC,IAAI,KAAK,SAAS;AAAA,MACjD;AAAA,IACF;AAAA,EACF;AACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtKA,GAAG,WAAW,eAAe;"}