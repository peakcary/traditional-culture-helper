{"version":3,"file":"WuxingRadar.js","sources":["components/WuxingRadar.vue","/Users/cary/work/traditional-culture-helper/components/WuxingRadar.vue?type=component"],"sourcesContent":["<template>\n  <view class=\"radar-container\">\n    <canvas \n      id=\"wuxingRadar\" \n      canvas-id=\"wuxingRadar\"\n      class=\"radar-canvas\"\n      :style=\"{width: size + 'px', height: size + 'px'}\"\n      @touchstart=\"handleTouch\"\n    ></canvas>\n    \n    <!-- 五行说明 -->\n    <view class=\"radar-legend\">\n      <view \n        v-for=\"(item, key) in wuxingData\" \n        :key=\"key\"\n        class=\"legend-item\"\n        :class=\"'legend-' + key\"\n      >\n        <view class=\"legend-color\" :style=\"{backgroundColor: getWuxingColor(key)}\"></view>\n        <text class=\"legend-name\">{{ key }}</text>\n        <text class=\"legend-value\">{{ item.toFixed(1) }}</text>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script setup>\nimport { ref, onMounted, watch, nextTick, defineProps, defineEmits } from 'vue'\n\n// Props 定义\nconst props = defineProps({\n  wuxingData: {\n    type: Object,\n    default: () => ({\n      '木': 0, '火': 0, '土': 0, '金': 0, '水': 0\n    })\n  },\n  size: {\n    type: Number,\n    default: 300\n  }\n})\n\n// Emits 定义\nconst emit = defineEmits(['touch'])\n\n// 响应式状态\nconst ctx = ref(null)\nconst centerX = ref(0)\nconst centerY = ref(0)\nconst radius = ref(0)\n\n// 方法定义\nconst initCanvas = () => {\n  const context = uni.createCanvasContext('wuxingRadar')\n  ctx.value = context\n  centerX.value = props.size / 2\n  centerY.value = props.size / 2\n  radius.value = (props.size * 0.8) / 2\n}\n\nconst drawRadar = () => {\n  if (!ctx.value) return\n  \n  // 清空画布\n  ctx.value.clearRect(0, 0, props.size, props.size)\n  \n  // 绘制背景网格\n  drawGrid()\n  \n  // 绘制五行数据\n  drawWuxingData()\n  \n  // 绘制标签\n  drawLabels()\n  \n  ctx.value.draw()\n}\n\nconst drawGrid = () => {\n  const context = ctx.value\n  const steps = 5 // 5个层级\n  \n  context.setLineCap('round')\n  context.setLineJoin('round')\n  \n  // 绘制同心多边形\n  for (let i = 1; i <= steps; i++) {\n    const r = (radius.value / steps) * i\n    context.beginPath()\n    context.setStrokeStyle('#e0e6ed')\n    context.setLineWidth(1)\n    \n    for (let j = 0; j < 5; j++) {\n      const angle = (j * 2 * Math.PI) / 5 - Math.PI / 2\n      const x = centerX.value + r * Math.cos(angle)\n      const y = centerY.value + r * Math.sin(angle)\n      \n      if (j === 0) {\n        context.moveTo(x, y)\n      } else {\n        context.lineTo(x, y)\n      }\n    }\n    \n    context.closePath()\n    context.stroke()\n  }\n  \n  // 绘制从中心到顶点的线\n  for (let i = 0; i < 5; i++) {\n    const angle = (i * 2 * Math.PI) / 5 - Math.PI / 2\n    const x = centerX.value + radius.value * Math.cos(angle)\n    const y = centerY.value + radius.value * Math.sin(angle)\n    \n    context.beginPath()\n    context.moveTo(centerX.value, centerY.value)\n    context.lineTo(x, y)\n    context.setStrokeStyle('#e0e6ed')\n    context.setLineWidth(1)\n    context.stroke()\n  }\n}\n\nconst drawWuxingData = () => {\n  const context = ctx.value\n  const wuxingOrder = ['木', '火', '土', '金', '水']\n  \n  // 找到最大值用于标准化\n  const maxValue = Math.max(...Object.values(props.wuxingData), 1)\n  \n  // 绘制填充区域\n  context.beginPath()\n  context.setFillStyle('rgba(52, 152, 219, 0.3)')\n  context.setStrokeStyle('#3498db')\n  context.setLineWidth(2)\n  \n  wuxingOrder.forEach((wx, index) => {\n    const value = props.wuxingData[wx] || 0\n    const normalizedValue = value / maxValue\n    const r = radius.value * normalizedValue\n    const angle = (index * 2 * Math.PI) / 5 - Math.PI / 2\n    const x = centerX.value + r * Math.cos(angle)\n    const y = centerY.value + r * Math.sin(angle)\n    \n    if (index === 0) {\n      context.moveTo(x, y)\n    } else {\n      context.lineTo(x, y)\n    }\n  })\n  \n  context.closePath()\n  context.fill()\n  context.stroke()\n  \n  // 绘制数据点\n  wuxingOrder.forEach((wx, index) => {\n    const value = props.wuxingData[wx] || 0\n    const normalizedValue = value / maxValue\n    const r = radius.value * normalizedValue\n    const angle = (index * 2 * Math.PI) / 5 - Math.PI / 2\n    const x = centerX.value + r * Math.cos(angle)\n    const y = centerY.value + r * Math.sin(angle)\n    \n    // 绘制数据点\n    context.beginPath()\n    context.arc(x, y, 4, 0, 2 * Math.PI)\n    context.setFillStyle(getWuxingColor(wx))\n    context.fill()\n    \n    // 绘制边框\n    context.beginPath()\n    context.arc(x, y, 4, 0, 2 * Math.PI)\n    context.setStrokeStyle('#fff')\n    context.setLineWidth(2)\n    context.stroke()\n  })\n}\n\nconst drawLabels = () => {\n  const context = ctx.value\n  const wuxingOrder = ['木', '火', '土', '金', '水']\n  \n  context.setFontSize(14)\n  context.setFillStyle('#2c3e50')\n  context.setTextAlign('center')\n  \n  wuxingOrder.forEach((wx, index) => {\n    const angle = (index * 2 * Math.PI) / 5 - Math.PI / 2\n    const labelRadius = radius.value + 20\n    const x = centerX.value + labelRadius * Math.cos(angle)\n    const y = centerY.value + labelRadius * Math.sin(angle)\n    \n    context.fillText(wx, x, y + 5)\n  })\n}\n\nconst getWuxingColor = (wuxing) => {\n  const colors = {\n    '木': '#2ecc71',  // 绿色\n    '火': '#e74c3c',  // 红色\n    '土': '#f39c12',  // 橙色\n    '金': '#95a5a6',  // 灰色\n    '水': '#3498db'   // 蓝色\n  }\n  return colors[wuxing] || '#95a5a6'\n}\n\nconst handleTouch = (e) => {\n  emit('touch', e)\n  console.log('Radar touched:', e)\n}\n\n// 生命周期\nonMounted(() => {\n  nextTick(() => {\n    initCanvas()\n    drawRadar()\n  })\n})\n\n// 监听器\nwatch(() => props.wuxingData, () => {\n  nextTick(() => {\n    drawRadar()\n  })\n}, { deep: true })\n</script>\n\n<style lang=\"scss\" scoped>\n.radar-container {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20rpx;\n}\n\n.radar-canvas {\n  border-radius: 15rpx;\n  background: #f8f9fa;\n  margin-bottom: 30rpx;\n  box-shadow: 0 4rpx 12rpx rgba(0, 0, 0, 0.1);\n}\n\n.radar-legend {\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: center;\n  gap: 20rpx;\n  \n  .legend-item {\n    display: flex;\n    align-items: center;\n    padding: 8rpx 16rpx;\n    background: white;\n    border-radius: 20rpx;\n    box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\n    \n    .legend-color {\n      width: 20rpx;\n      height: 20rpx;\n      border-radius: 50%;\n      margin-right: 10rpx;\n    }\n    \n    .legend-name {\n      font-size: 24rpx;\n      color: #2c3e50;\n      margin-right: 8rpx;\n      font-weight: 500;\n    }\n    \n    .legend-value {\n      font-size: 22rpx;\n      color: #7f8c8d;\n      font-weight: bold;\n    }\n  }\n}\n</style>","import Component from '/Users/cary/work/traditional-culture-helper/components/WuxingRadar.vue'\nwx.createComponent(Component)"],"names":["ref","uni","wx","onMounted","nextTick","watch"],"mappings":"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"}